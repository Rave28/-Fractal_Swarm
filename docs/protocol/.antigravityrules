# ðŸ§¬ Fractal Swarm Protocol V2 (God-Mode Orchestration)

This blueprint defines the optimized, maximum-utilization state machine for Autonomous AI coding. It forces the complete integration of the **Sequential Thinking** MCP, the **DeepCode** nanobot endpoints, and the **MyBrain** semantic cache.

## The Three Pillars of Execution

### 1. The Eyes (DeepCode Observation)

The engine must never guess the state of the workspace.

- **Trigger**: `deepcode-implementation.get_file_structure`
  - Instantly maps the entire directory tree without manual recursive `ls` commands.
- **Trigger**: `deepcode-implementation.read_code_mem`
  - Interrogates `implement_code_summary.md` to see if architectural decisions on these files have already been made and documented.
- **Trigger**: `deepcode-implementation.search_code`
  - Uses regex to pinpoint exact implementation injection zones across the codebase.

### 2. The Brain (Sequential Thinking + MyBrain Oracle)

The engine must never write code without an algorithmic blueprint.

- **Trigger**: `Sequential Thinking` MCP
  - The main thread shifts into a structured Thought Node to form a hypothesis based on the `deepcode` telemetry.
- **Trigger**: `Knowledge Broker` (`Invoke-RestMethod` to `127.0.0.1:8000/research`)
  - From within the thought node, the engine queries the local Semantic Cache.
  - If `< 0.45` distance: Instant cache hit. Proceed.
  - If `> 0.45` distance: MyBrain fetches the live `sonar-pro` architecture, mem-caches it, and returns it to the thought node.
- **Fallback Trigger**: `deepcode-brain.research_to_code`
  - If the task requires deep computer science (e.g., implementing a new ArXiv paper), the engine defers to the multi-agent DeepCode researcher to generate the preliminary structural artifacts.

### 3. The Hands (DeepCode Nanobot Swarm)

The engine must never write individual files sequentially, and must safely prove its logic before touching production code.

- **Trigger**: `deepcode-implementation.execute_bash` / `execute_python` (Spike Testing)
  - The engine generates a tiny, isolated sandbox script in `/tmp/` to prove the hypothesis generated by the Thought Node.
- **Trigger**: `deepcode-implementation.write_multiple_files` (The Payload)
  - Once the spike test glows green, the swarm fires a single JSON payload to overwrite/create all 5+ architectural files simultaneously in Sub-Second time.
- **Trigger**: `get_operation_history` (The Anti-Loop Guardrail)
  - The engine fires `pytest`. If it fails, it calls `get_operation_history` *before* rewriting code, giving it exact awareness of what the nanobots just changed to prevent infinite reversion loops.
- **Trigger**: `deepcode-implementation.write_file` (Memory Commit)
  - Upon a successful green test suite, the engine MUST append a highly technical summary of the architectural changes, updated dependencies, and routing logic to `implement_code_summary.md`. This ensures `deepcode-implementation.read_code_mem` has accurate state data for the next Swarm cycle.

## The Execution Law

The engine is strictly forbidden from bypassing this loop during architectural tasks. Every prompt mapping to a system-level refactor, new feature construction, or complex debugging session must route through the `Eyes -> Brain -> Hands` state machine using the explicit MCP triggers listed above.
